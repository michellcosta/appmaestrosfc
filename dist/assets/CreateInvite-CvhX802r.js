import{j as e}from"./vendor-ui-Crwl98nu.js";import{r as s,b as a}from"./vendor-react-Cf1qRDNe.js";import{u as t,C as i,d as r,b as l,e as n,S as c,Z as o,B as d}from"./index-D4lv_L5s.js";import{I as m}from"./input-DgMKldUO.js";import{L as x}from"./label-C1dG6DTd.js";import{S as p,a as j,b as h,c as u,d as v}from"./select-DOFi3y6O.js";import{B as g}from"./badge-BqDrbTf5.js";import{T as N,a as f,b as y,c as b}from"./tabs-iWnRdRAn.js";import{S as w}from"./shield-Cw7Op2NE.js";import{U as C}from"./user-plus-mEtGn1I1.js";import{M as S}from"./mail-Chy-w8Gm.js";import{U as D}from"./users-BSGs48q5.js";import{C as I}from"./copy-4jP_ujrs.js";import"./vendor-router-Cpu-KcQe.js";import"./vendor-supabase-Dvt-yfip.js";import"./vendor-utils-CRulVwns.js";import"./check-BOIfqwE8.js";function A(){const{user:A}=t(),[k,E]=s.useState(!1),[L,O]=s.useState(""),[z,B]=s.useState([]),[M,U]=s.useState({type:"mensalista",email:"",expiresIn:"1"});if(!A||!["owner","admin","aux"].includes(A.role||""))return e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(i,{children:e.jsxs(r,{className:"p-6 text-center space-y-4",children:[e.jsx(w,{className:"w-12 h-12 mx-auto text-red-500"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Acesso Restrito"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Apenas Owner, Admin ou Auxiliar podem criar convites."})]})})});const V=e=>"mensalista"===e?"bg-purple-100 text-purple-800":"bg-orange-100 text-orange-800";return a.useEffect(()=>{const e=JSON.parse(localStorage.getItem("invites")||"[]");B(e)},[]),e.jsxs("div",{className:"p-4 sm:p-6 space-y-6 pb-20",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(C,{className:"w-6 h-6 text-blue-600"}),"Criar Convites"]}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Convide novos jogadores para o grupo"})]}),e.jsxs(N,{defaultValue:"create",className:"w-full",children:[e.jsxs(f,{className:"grid w-full grid-cols-2",children:[e.jsx(y,{value:"create",children:"Criar Convite"}),e.jsx(y,{value:"list",children:"Convites Enviados"})]}),e.jsx(b,{value:"create",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(l,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),"Novo Convite"]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"type",children:"Tipo de Convite"}),e.jsxs(p,{value:M.type,onValueChange:e=>U({...M,type:e}),children:[e.jsx(j,{children:e.jsx(h,{})}),e.jsxs(u,{children:[e.jsx(v,{value:"mensalista",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-4 h-4"}),"Mensalista"]})}),e.jsx(v,{value:"diarista",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"w-4 h-4"}),"Diarista"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"email",children:"Email do Convidado"}),e.jsx(m,{id:"email",type:"email",value:M.email,onChange:e=>U({...M,email:e.target.value}),placeholder:"exemplo@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"expires",children:"Validade (dias)"}),e.jsxs(p,{value:M.expiresIn,onValueChange:e=>U({...M,expiresIn:e}),children:[e.jsx(j,{children:e.jsx(h,{})}),e.jsxs(u,{children:[e.jsx(v,{value:"1",children:"1 dia"}),e.jsx(v,{value:"3",children:"3 dias"}),e.jsx(v,{value:"7",children:"7 dias"})]})]})]}),e.jsx(d,{onClick:async()=>{E(!0),O("");try{if(!M.email)return void O("Digite o email do convidado!");const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),s=24*parseInt(M.expiresIn)*60*60*1e3,a=new Date(Date.now()+s).toISOString(),t={id:`invite-${Date.now()}`,type:M.type,email:M.email,token:e,createdBy:A.name||"Usuário",createdAt:(new Date).toISOString(),expiresAt:a,used:!1},i=JSON.parse(localStorage.getItem("invites")||"[]");i.push(t),localStorage.setItem("invites",JSON.stringify(i)),B(i),O(`Convite ${M.type} criado com sucesso!`),U({type:"mensalista",email:"",expiresIn:"1"})}catch(e){O(`Erro: ${e}`)}finally{E(!1)}},disabled:k,className:"w-full",children:k?"Criando...":"Criar Convite"}),L&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-800",children:L})})]})]})}),e.jsx(b,{value:"list",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(l,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Convites Enviados"]})}),e.jsx(r,{children:0===z.length?e.jsx("p",{className:"text-sm text-zinc-500 text-center py-4",children:"Nenhum convite enviado ainda"}):e.jsx("div",{className:"space-y-3",children:z.map(s=>{const a=(e=>e.used?{text:"Usado",color:"bg-green-100 text-green-800"}:new Date>new Date(e.expiresAt)?{text:"Expirado",color:"bg-red-100 text-red-800"}:{text:"Ativo",color:"bg-blue-100 text-blue-800"})(s);return e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(t=s.type,"mensalista"===t?e.jsx(c,{className:"w-4 h-4"}):e.jsx(o,{className:"w-4 h-4"})),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.email}),e.jsxs("p",{className:"text-sm text-zinc-500",children:["Criado em ",new Date(s.createdAt).toLocaleDateString("pt-BR")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:V(s.type),children:"mensalista"===s.type?"Mensalista":"Diarista"}),e.jsx(g,{className:a.color,children:a.text})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>(e=>{const s=`${window.location.origin}/accept-invite?token=${e}`;navigator.clipboard.writeText(s),O("Link copiado para a área de transferência!")})(s.token),children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Copiar Link"]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Expira em ",new Date(s.expiresAt).toLocaleDateString("pt-BR")]})]}),s.used&&e.jsxs("div",{className:"p-2 bg-green-50 rounded text-sm text-green-800",children:["✅ Usado em ",new Date(s.usedAt).toLocaleDateString("pt-BR")]})]},s.id);var t})})})]})})]})]})}export{A as default};
