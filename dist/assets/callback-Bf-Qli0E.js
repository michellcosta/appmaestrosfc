import{j as e}from"./vendor-ui-Cg0qxSES.js";import{u as r}from"./useGoogleAuth-BrkrQYSG.js";import{r as o}from"./vendor-react-CyD6OLG_.js";import{s as t,a as s}from"./index-XxW9FBxQ.js";import{u as n}from"./vendor-router-VFXGavtY.js";import"./vendor-pdf-oqmhCI76.js";import"./vendor-utils-CrFdsnXa.js";function a(){return function(){const e=window.location.hostname;return e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.")||"localhost"===e}()?"http://localhost:5173/auth/callback":`${window.location.origin}/auth/callback`}function i(){const i=n(),{createOrUpdateProfile:c}=r(),[l,d]=o.useState("loading"),[u,m]=o.useState(""),g=o.useRef(!1),h=t(s.googleAuth.exchangeCodeForToken);return o.useEffect(()=>{if(g.current)return;g.current=!0;(async()=>{try{const e=new URLSearchParams(window.location.search),r=e.get("code"),o=e.get("error");if(o)throw new Error(`Erro do Google: ${o}`);if(!r)throw new Error("Código de autorização não encontrado");const t=await h({code:r,redirectUri:a()});if(!t.success||!t.userInfo)throw new Error(t.error||"Falha na autenticação");const s=t.userInfo;await c(s.email,s.name,"owner",s.picture),d("success"),m("✅ Login realizado com sucesso!");const n={id:s.id,email:s.email,name:s.name,avatar_url:s.picture,role:"owner",group_id:`group_${Date.now()}`};localStorage.setItem("offline_user",JSON.stringify(n)),setTimeout(()=>{i("/home")},1e3)}catch(e){d("error"),m(`❌ Erro: ${e.message}`),setTimeout(()=>{i("/login")},3e3)}})()},[]),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-blue-50 to-emerald-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-full mb-4",children:["loading"===l&&e.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"}),"success"===l&&e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"error"===l&&e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:["loading"===l&&"Processando login...","success"===l&&"Login realizado!","error"===l&&"Erro no login"]}),e.jsxs("p",{className:"text-gray-600",children:["loading"===l&&"Aguarde enquanto processamos seu login com o Google.","success"===l&&"Redirecionando para o app...","error"===l&&"Ocorreu um erro durante o processo de login. Redirecionando..."]})]}),u&&e.jsx("div",{className:"p-4 rounded-lg "+("success"===l?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"),children:u}),"error"===l&&e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>i("/login"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Tentar novamente"})})]})})}export{i as default};
