import{j as e}from"./vendor-ui-Cg0qxSES.js";import{u as s,a}from"./useAutoSync-DHWSpEGJ.js";import{r as t}from"./vendor-react-CyD6OLG_.js";import{c as r,k as n,a as i,u as l,h as c,g as d,B as o,C as m,f as x,T as h,U as u,S as g,Z as j,l as p}from"./index-XxW9FBxQ.js";import{D as b,a as f,b as v,c as N,e as y,d as w}from"./dialog-C8tkcOsA.js";import{L as z}from"./label-CfKHBYYN.js";import{S as k,a as C,b as S,c as A,d as P}from"./select-DPwYioei.js";import{T as E,a as M,b as T}from"./tabs-DCR6OKyG.js";import{u as V}from"./usePermissions-C7BJFuWB.js";import{u as D}from"./useTeamDrawConvex-vOr6iHt4.js";import{u as I}from"./gamesStore-CEKKs3cA.js";import{u as _}from"./matchStore-Cq_uepae.js";import{c as B,p as O,a as G}from"./middleware-BLDYzNRS.js";import{u as L}from"./vendor-router-VFXGavtY.js";import{C as J}from"./crown-CyBj_N2G.js";import{T as $}from"./trash-2-__SYsBQH.js";import{S as R}from"./sparkles-O0siDYuT.js";import{D as q}from"./database-Ce_Wfjf8.js";import{S as F}from"./shield-DWCzQdRN.js";import"./vendor-pdf-oqmhCI76.js";import"./vendor-utils-CrFdsnXa.js";import"./check-Cf6Eusfg.js";const H=r("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),U=r("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Z=r("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const Q=B()(O((e,s)=>({players:[],teamDraw:null,currentMatchId:null,loading:!1,error:null,setCurrentMatch:s=>{e({currentMatchId:s})},loadPlayersFromTeamDraw:async s=>{e({loading:!0,error:null});try{const a=localStorage.getItem(`teamDraw_${s}`);if(a){const{teamDraw:s,players:t}=JSON.parse(a);e({teamDraw:s,players:t,loading:!1})}else e({teamDraw:null,players:[],loading:!1})}catch(a){e({error:a.message||"Erro ao carregar jogadores",loading:!1})}},drawTeams:async(s,a=5)=>{e({loading:!0,error:null});try{const r=[],n=["convex_players","offline_players","local_players","players-store","nexus-play-players","app_players"];for(const e of n){const s=localStorage.getItem(e);if(s)try{const e=JSON.parse(s);if(Array.isArray(e)){if(e.length>0){e[0]}r.push(...e)}else e.players&&Array.isArray(e.players)?r.push(...e.players):e.state&&Array.isArray(e.state.players)&&r.push(...e.state.players)}catch(t){}}if(0===r.length)return void e({players:[],currentMatchId:s,loading:!1,error:"Nenhum jogador cadastrado. Cadastre jogadores no sistema primeiro."});const i=["Gol","Zaga","Meio","Atacante"],l=["Preto","Verde","Cinza","Vermelho"],c=r.filter(e=>{const s=e&&e.name;return s}).sort(()=>Math.random()-.5),d=[];let o=0;for(let e=0;e<l.length;e++){const s=l[e],t=c.length-o,r=l.length-e;let n;t>=a*r?n=a:(n=Math.floor(t/r),e<t%r&&(n+=1));for(let e=0;e<n&&o<c.length;e++){const e=c[o];d.push({...e,team_color:s,is_substitute:!1,position:e.position||i[Math.floor(Math.random()*i.length)]}),o++}}e({players:d,currentMatchId:s,loading:!1,error:null})}catch(r){e({error:r.message||"Erro ao sortear times",loading:!1})}},getPlayersByTeam:e=>(s().players||[]).filter(s=>s.team_color===e),getActivePlayersByTeam:e=>(s().players||[]).filter(s=>s.team_color===e&&!s.is_substitute),getAvailablePlayersForTeam:e=>(s().players||[]).filter(s=>s.team_color===e),getAllAvailablePlayers:()=>(s().players||[]).filter(e=>e.team_color),substitutePlayer:(s,a,t)=>{e(e=>({players:e.players.map(e=>e.id===s?{...e,is_substitute:!0,substituted_at:new Date}:e.id===a?{...e,team_color:t,is_substitute:!1}:e)}))},addSubstitution:(e,a,t)=>{const r=s(),n=r.getPlayerByName(a),i=r.getPlayerByName(t);if(!n)throw new Error(`Jogador "${a}" não encontrado`);if(!i)throw new Error(`Jogador "${t}" não encontrado`);if(n.team_color!==e)throw new Error(`Jogador "${a}" não pertence ao time ${e}`);if(i.team_color!==e)throw new Error(`Jogador "${t}" não pertence ao time ${e}`);if(n.is_substitute)throw new Error(`Jogador "${a}" já está no banco`);if(!i.is_substitute)throw new Error(`Jogador "${t}" já está em campo`);if(a===t)throw new Error("Jogador que sai deve ser diferente do que entra");r.substitutePlayer(n.id,i.id,e)},addPlayerToTeam:(s,a)=>{e(e=>({players:[...e.players,{...s,team_color:a,is_substitute:!1}]}))},removePlayerFromTeam:s=>{e(e=>({players:e.players.filter(e=>e.id!==s)}))},searchPlayers:e=>{const a=e.toLowerCase();return s().players.filter(e=>e.name.toLowerCase().includes(a)||e.position?.toLowerCase().includes(a))},getPlayerById:e=>s().players.find(s=>s.id===e),getPlayerByName:e=>s().players.find(s=>s.name.toLowerCase()===e.toLowerCase()),canPlayerScore:(e,a)=>{const t=s().getPlayerById(e);return t?.team_color===a&&!t?.is_substitute},canPlayerAssist:(e,a,t)=>{const r=s().getPlayerById(e),n=s().getPlayerById(a);return e!==a&&(r?.team_color===t&&n?.team_color===t&&!r?.is_substitute&&!n?.is_substitute)},clearTeamDraw:()=>{e({teamDraw:null,players:[],currentMatchId:null})},reset:()=>{e({players:[],teamDraw:null,currentMatchId:null,loading:!1,error:null})}}),{name:"players-store",storage:G(()=>localStorage),partialize:e=>({players:e.players,teamDraw:e.teamDraw,currentMatchId:e.currentMatchId})})),Y={Preto:"bg-zinc-800 text-white border-2 border-zinc-300 dark:border-zinc-600",Verde:"bg-emerald-600 text-white border-2 border-emerald-300 dark:border-emerald-400",Cinza:"bg-slate-500 text-white border-2 border-slate-300 dark:border-slate-400",Vermelho:"bg-red-600 text-white border-2 border-red-300 dark:border-red-400"},K=({color:s,className:a})=>e.jsx("span",{className:["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium w-8 h-8 shadow-md",Y[s],a||""].join(" ")}),W=()=>{const{round:r,durationMin:p,events:B,allEvents:O,history:G,setDuration:q,start:H,pause:Z,reset:Y,addGoal:W,editGoal:ee,deleteGoal:se,endRoundChooseNext:ae,getAllEvents:te,clearHistory:re,clearEvents:ne,clearAll:ie,resetToInitialState:le,recomputeScores:ce}=_(),{addGoal:de,addAssist:oe,removeGoal:me,removeAssist:xe}=s(),{createMatch:he,addGoal:ue,addCard:ge}=function(){try{const e=n(i.matches.list),s=n(i.matches.list,{status:"pending"}),a=n(i.matches.list,{status:"live"}),t=n(i.matches.list,{status:"ended"}),r=l(i.matches.create),c=l(i.matches.drawTeams),d=l(i.matches.start),o=l(i.matches.end),m=l(i.matches.addGoal),x=l(i.matches.addCard);return{matches:e||[],pendingMatches:s||[],liveMatches:a||[],endedMatches:t||[],createMatch:async e=>{try{return await r({title:e.title,date:e.date,userId:e.userId})}catch(s){throw s}},drawTeams:async(e,s)=>{try{return await c({matchId:e,playerIds:s})}catch(a){throw a}},startMatch:async e=>{try{await d({matchId:e})}catch(s){throw s}},endMatch:async e=>{try{await o({matchId:e})}catch(s){throw s}},addGoal:async e=>{try{return await m(e)}catch(s){throw s}},addCard:async e=>{try{return await x(e)}catch(s){throw s}},isLoading:void 0===e}}catch(e){return{matches:[],pendingMatches:[],liveMatches:[],endedMatches:[],createMatch:async()=>{throw new Error("Convex não disponível")},drawTeams:async()=>{throw new Error("Convex não disponível")},startMatch:async()=>{throw new Error("Convex não disponível")},endMatch:async()=>{throw new Error("Convex não disponível")},addGoal:async()=>{throw new Error("Convex não disponível")},addCard:async()=>{throw new Error("Convex não disponível")},isLoading:!1}}}();c();const{players:je,currentMatchId:pe,setCurrentMatch:be,loadPlayersFromTeamDraw:fe,getPlayersByTeam:ve,getActivePlayersByTeam:Ne,substitutePlayer:ye,addSubstitution:we,getPlayerByName:ze}=Q(),{getPlayersByTeam:ke,loadTeamDraw:Ce}=D(),{getUpcomingMatches:Se}=I();t.useEffect(()=>{const e=Se();if(e.length>0){const s=e[0].id.toString();be(s)}else{be("1")}},[be,Se]),t.useEffect(()=>{pe&&Ce(pe).catch(e=>{})},[pe,Ce]);const{canControlMatch:Ae}=V(),{isOnline:Pe,isSyncing:Ee}=a(),Me=()=>{const e=[];return["Preto","Verde","Cinza","Vermelho"].forEach(s=>{ke(s).length>0&&e.push(s)}),e},{user:Te}=d(),Ve=L(),De=r&&Array.isArray(r.inPlay)&&2===r.inPlay.length?r:{inPlay:["Preto","Verde"],scores:{},number:r?.number??1,running:!!r?.running},Ie=Array.isArray(B)?B:[],_e=Array.isArray(G)?G:[],Be=_(e=>{const s="number"==typeof e.now?e.now:Date.now();return("number"==typeof e.accumulatedSec?e.accumulatedSec:0)+(e.runningSince?Math.max(Math.floor((s-e.runningSince)/1e3),0):0)}),Oe=Be>=60*p,Ge=t.useRef(null);t.useEffect(()=>{const e=Ge.current;if(e)if(Oe&&!De.running)e.loop=!0,e.volume=.5,e.play().catch(()=>{});else try{e.pause(),e.currentTime=0}catch{}},[Oe,De.running]),t.useEffect(()=>{De.running&&Oe&&Z()},[Oe,De.running,Z]);const Le=t.useMemo(()=>Math.floor(Be/60).toString().padStart(2,"0")+":"+(Be%60).toString().padStart(2,"0"),[Be]),[Je,$e]=t.useState(!1);t.useState(!1);const[Re,qe]=t.useState(null),[Fe,He]=t.useState("Preto"),[Ue,Ze]=t.useState(""),[Qe,Ye]=t.useState("none"),[Ke,We]=t.useState(!1),[Xe,es]=t.useState(null);t.useEffect(()=>{(async()=>{try{const e=pe||"default_match";await fe(e)}catch(e){}})()},[fe,pe]);const[ss,as]=t.useState(!1),[ts,rs]=t.useState("Preto"),[ns,is]=t.useState(!1),[ls,cs]=t.useState("Preto"),[ds,os]=t.useState(""),[ms,xs]=t.useState(""),[hs,us]=t.useState(!1),[gs,js]=t.useState(null),[ps,bs]=t.useState(!1),[fs,vs]=t.useState(null),[Ns,ys]=t.useState(!1),[ws,zs]=t.useState(null),[ks,Cs]=t.useState(null);t.useEffect(()=>()=>{ks&&clearTimeout(ks)},[ks]);const Ss=()=>{ks&&(clearTimeout(ks),Cs(null)),bs(!1),vs(null),ys(!1),zs(null)},As=e=>{const s=ke(e);if(s.length>0){return s.map(e=>e.name)}return[]},Ps=e=>{qe(e.id),He(e.team),Ze(e.author||As(e.team)[0]||""),Ye(e.assist??"none"),$e(!0)},Es=e=>{es(e),We(!0)};t.useEffect(()=>{Je&&"none"!==Qe&&Qe===Ue&&Ye("none")},[Ue,Qe,Je]),t.useEffect(()=>{ce()},[ce]);const[Ms,Ts]=De.inPlay;De.scores[Ms],De.scores[Ts];const Vs=["Preto","Verde","Cinza","Vermelho"].filter(e=>e!==Ms&&e!==Ts),Ds=t.useMemo(()=>{const e=Array.isArray(O)?O:[],s={};for(const a of e)a.author&&(s[a.author]=s[a.author]||{g:0,a:0},s[a.author].g+=1),a.assist&&(s[a.assist]=s[a.assist]||{g:0,a:0},s[a.assist].a+=1);return Object.entries(s).map(([e,s])=>({name:e,g:s.g,a:s.a})).sort((e,s)=>s.g-e.g||s.a-e.a||e.name.localeCompare(s.name))},[O]),[Is,_s]=t.useState("week"),Bs=t.useMemo(()=>{const e=_e;if("all"===Is)return e;const s=new Date;return e.filter(e=>{const a=new Date(e.ts);if("week"===Is){return(s.getTime()-a.getTime())/864e5<=7}return a.getMonth()===s.getMonth()&&a.getFullYear()===s.getFullYear()})},[_e,Is]),Os=()=>{try{const e=Ge.current;e&&(e.pause(),e.currentTime=0)}catch{}Y()},Gs=()=>{const[e,s]=r.inPlay;if((r.scores[e]??0)===(r.scores[s]??0))return void((e,s)=>{const a=["Preto","Verde","Cinza","Vermelho"];if(!a.includes(e)||!a.includes(s))return;Ss(),ys(!0),bs(!0);const t=setTimeout(()=>{const a=Math.random()>.5?e:s;vs(a),ys(!1),Cs(null)},3e3);Cs(t)})(e,s);const a=["Preto","Verde","Cinza","Vermelho"];if("Cinza"!==e&&"Cinza"!==s)rs("Cinza");else{const t=a.filter(a=>a!==e&&a!==s);rs(t[0]||"Preto")}as(!0)},Ls=e=>{const s=ke(e),a=Ne(e);return{playersOut:a.map(e=>e.name),playersIn:s.filter(e=>!a.find(s=>s.name===e.name)).map(e=>e.name)}};return e.jsxs("div",{className:"mx-auto w-full max-w-4xl px-4 py-5 pb-[120px] sm:pb-5",children:[e.jsx("header",{className:"bg-white dark:bg-zinc-800 border-b border-gray-200 dark:border-zinc-700 shadow-sm rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900 dark:text-zinc-100",children:"Partida ao Vivo"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-zinc-400",children:["Rodada ",De.number]}),!Pe&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-amber-600 mt-1",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full"}),"Modo Offline"]}),Pe&&Ee&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 mt-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Sincronizando..."]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:["owner"===Te?.role&&e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>Ve("/owner-dashboard"),className:"p-2 hover:bg-purple-100 dark:hover:bg-purple-900/30 hover:text-purple-700 dark:hover:text-purple-300 transition-colors",title:"Acesso rápido ao Dashboard do Owner",children:e.jsx(J,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),Te?.role&&"owner"!==Te.role&&e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-maestros-green dark:text-green-400",children:[(s=>{switch(s){case"owner":return e.jsx(J,{className:"w-4 h-4 text-role-owner"});case"admin":return e.jsx(F,{className:"w-4 h-4 text-role-admin"});case"aux":return e.jsx(j,{className:"w-4 h-4 text-role-aux"});case"mensalista":return e.jsx(g,{className:"w-4 h-4 text-role-mensalista"});case"diarista":return e.jsx(j,{className:"w-4 h-4 text-role-diarista"});default:return e.jsx(u,{className:"w-4 h-4 text-role-default"})}})(Te.role),e.jsx("span",{className:"hidden sm:inline font-medium",children:"admin"===Te.role?"Admin":"aux"===Te.role?"Auxiliar":"mensalista"===Te.role?"Mensalista":"diarista"===Te.role?"Diarista":"Usuário"})]})]})]})}),e.jsx(m,{className:"mb-3 rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-800",children:e.jsx(x,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:["text-5xl sm:text-6xl font-extrabold tabular-nums",Oe&&!De.running?"text-red-600 motion-safe:animate-pulse [animation-duration:350ms]":""].join(" "),"aria-live":"polite",children:Le}),e.jsx("audio",{ref:Ge,preload:"auto",className:"hidden",src:"data:audio/wav;base64,UklGRm4AAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAAAChAAAAAAAaAABSUQAA////AP///wD///8A////AP///wD///8A////AP///wD///8A"}),Ae()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"text-sm text-zinc-600",children:"Duração:"}),e.jsxs(k,{value:String(p),onValueChange:e=>q(Number(e)),disabled:De.running,children:[e.jsx(C,{className:"w-[110px]",children:e.jsx(S,{placeholder:"Minutos"})}),e.jsx(A,{children:[5,8,10,12,15].map(s=>e.jsxs(P,{value:String(s),children:[s," min"]},s))})]})]}),Ae()&&e.jsxs("div",{className:"hidden w-full sm:grid grid-cols-3 gap-2",children:[De.running?e.jsx(o,{type:"button",onClick:Z,className:"h-12 w-full bg-amber-500 hover:bg-amber-500/90",children:"Pausar"}):e.jsx(o,{type:"button",onClick:H,className:"h-12 w-full",children:"Iniciar"}),e.jsx(o,{type:"button",onClick:Os,className:"h-12 w-full bg-sky-500 hover:bg-sky-600 text-white",children:"Recomeçar"}),e.jsx(o,{type:"button",onClick:Gs,className:"h-12 w-full bg-rose-500 hover:bg-rose-600 text-white",children:"Encerrar"})]})]})})}),Ae()&&e.jsx("div",{className:"md:hidden mb-3",children:e.jsx(m,{className:"rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-800",children:e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[De.running?e.jsx("button",{type:"button",onClick:Z,className:"w-12 h-12 rounded-full bg-amber-500 hover:bg-amber-600 active:scale-95 transition-all duration-200 flex items-center justify-center text-white shadow-md hover:shadow-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})})}):e.jsx("button",{type:"button",onClick:H,className:"w-12 h-12 rounded-full bg-emerald-600 hover:bg-emerald-700 active:scale-95 transition-all duration-200 flex items-center justify-center text-white shadow-md hover:shadow-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})}),e.jsx("button",{type:"button",onClick:Os,className:"w-12 h-12 rounded-full bg-sky-500 hover:bg-sky-600 active:scale-95 transition-all duration-200 flex items-center justify-center text-white shadow-md hover:shadow-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})})}),e.jsx("button",{type:"button",onClick:Gs,className:"w-12 h-12 rounded-full bg-rose-500 hover:bg-rose-600 active:scale-95 transition-all duration-200 flex items-center justify-center text-white shadow-md hover:shadow-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 6h12v12H6z"})})})]})})})}),e.jsx(m,{className:"rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-800 mb-3",children:e.jsxs(x,{className:"p-4 sm:p-5",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2 mb-3",children:[e.jsx(h,{className:"h-4 w-4 text-emerald-600"})," Placar"]}),e.jsx("div",{className:"grid sm:grid-cols-2 gap-3",children:[Ms,Ts].map(s=>e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border px-3 py-2 min-h-12",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(K,{color:s}),e.jsx("span",{className:"text-sm truncate",children:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-bold tabular-nums",children:De.scores[s]??0}),Ae()&&Me().length>0&&e.jsx(o,{type:"button",variant:"outline",size:"sm",onClick:()=>(e=>{cs(e),os(""),xs(""),is(!0)})(s),disabled:!De.running,"aria-label":"Substituição do "+s,className:"h-8 w-8 p-0",children:"⇄"}),Ae()&&e.jsx(o,{type:"button",variant:"outline",size:"sm",onClick:()=>(e=>{De.running&&(qe(null),He(e),Ze(As(e)[0]??""),Ye("none"),$e(!0))})(s),disabled:!De.running,"aria-label":"Adicionar gol do "+s,className:"h-8 w-8 p-0",children:"+"})]})]},s))})]})}),e.jsx(m,{className:"rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-800 mb-3",children:e.jsxs(x,{className:"p-4 sm:p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Gols da partida"}),e.jsxs("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[Ie.length," ",1===Ie.length?"gol":"gols"," nesta partida"]})]}),0===Ie.length?e.jsx("p",{className:"text-sm text-zinc-500",children:"Nenhum gol registrado ainda."}):e.jsx("ul",{className:"space-y-2",children:Ie.slice().reverse().map(s=>e.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-lg border px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{color:s.team}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:e.jsx("strong",{children:s.author})}),s.assist&&e.jsxs("div",{className:"text-xs text-zinc-500",children:["assistência: ",s.assist]})]})]}),Ae()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{type:"button",variant:"outline",size:"icon",className:"sm:hidden",onClick:()=>Ps(s),"aria-label":"Editar gol",title:"Editar",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Editar"})]}),e.jsxs(o,{type:"button",variant:"secondary",size:"icon",className:"sm:hidden",onClick:()=>Es(s),"aria-label":"Excluir gol",title:"Excluir",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Excluir"})]}),e.jsx(o,{type:"button",variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:()=>Ps(s),children:"Editar"}),e.jsx(o,{type:"button",variant:"secondary",size:"sm",className:"hidden sm:inline-flex",onClick:()=>Es(s),children:"Excluir"})]})]},s.id))})]})}),e.jsx(m,{className:"rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-800 mb-3",children:e.jsxs(x,{className:"p-4 sm:p-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4 text-maestros-green"}),e.jsx("h3",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-100",children:"Estatísticas dos Jogadores"})]})}),0===Ds.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 bg-zinc-100 dark:bg-zinc-800 rounded-full flex items-center justify-center",children:e.jsx(h,{className:"w-6 h-6 text-zinc-400"})}),e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"Nenhum gol registrado ainda"}),e.jsx("p",{className:"text-xs text-zinc-400 dark:text-zinc-500 mt-1",children:"Os gols aparecerão aqui conforme forem marcados"})]}):e.jsxs("div",{className:"space-y-3",children:[Ds.slice(0,3).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-zinc-50 to-zinc-100 dark:from-zinc-800/50 dark:to-zinc-700/50 rounded-lg border border-zinc-200 dark:border-zinc-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-sm "+(0===a?"bg-yellow-500":1===a?"bg-gray-400":"bg-amber-600"),children:a+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-zinc-900 dark:text-zinc-100",children:s.name}),e.jsxs("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[s.g+s.a," participações • ",s.g,"G ",s.a,"A"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-emerald-600 dark:text-emerald-400",children:s.g}),e.jsx("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:"Gols"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:s.a}),e.jsx("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:"Assist."})]})]})]},s.name)),Ds.length>3&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-zinc-500 dark:text-zinc-400 mb-2",children:"Outros jogadores"}),Ds.slice(3).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-zinc-50 dark:bg-zinc-800/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-zinc-200 dark:bg-zinc-700 flex items-center justify-center",children:e.jsx(u,{className:"w-3 h-3 text-zinc-500"})}),e.jsx("span",{className:"text-sm font-medium text-zinc-700 dark:text-zinc-300",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("span",{className:"text-emerald-600 dark:text-emerald-400 font-medium",children:[s.g,"G"]}),e.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[s.a,"A"]})]})]},s.name))]})]}),Ds.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-700 dark:text-blue-300",children:[e.jsx(h,{className:"w-3 h-3"}),e.jsx("span",{children:'As estatísticas são persistentes e só zeram na próxima partida agendada ou ao usar "Reset Total"'})]})})]})}),e.jsx("div",{className:"mb-3",children:e.jsx(E,{value:Is,onValueChange:e=>_s(e),children:e.jsxs(M,{className:"grid grid-cols-3 w-full h-12 p-1 rounded-lg bg-zinc-100 dark:bg-zinc-800 items-center justify-center",children:[e.jsx(T,{value:"week",className:"flex items-center justify-center h-6 px-1.5 rounded text-xs font-medium transition-all data-[state=active]:bg-white data-[state=active]:text-zinc-900 data-[state=active]:shadow-sm dark:data-[state=active]:bg-zinc-700 dark:data-[state=active]:text-zinc-100 text-zinc-600 dark:text-zinc-300",children:"Semana"}),e.jsx(T,{value:"month",className:"flex items-center justify-center h-6 px-1.5 rounded text-xs font-medium transition-all data-[state=active]:bg-white data-[state=active]:text-zinc-900 data-[state=active]:shadow-sm dark:data-[state=active]:bg-zinc-700 dark:data-[state=active]:text-zinc-100 text-zinc-600 dark:text-zinc-300",children:"Mês"}),e.jsx(T,{value:"all",className:"flex items-center justify-center h-6 px-1.5 rounded text-xs font-medium transition-all data-[state=active]:bg-white data-[state=active]:text-zinc-900 data-[state=active]:shadow-sm dark:data-[state=active]:bg-zinc-700 dark:data-[state=active]:text-zinc-100 text-zinc-600 dark:text-zinc-300",children:"Todos"})]})})}),e.jsx(m,{className:"rounded-2xl border border-zinc-200 shadow-sm dark:border-zinc-800",children:e.jsxs(x,{className:"p-5 sm:p-7",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-4",children:"Histórico de Partidas"}),Bs.length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-zinc-50 to-zinc-100 dark:from-zinc-800/30 dark:to-zinc-700/30 rounded-lg border border-zinc-200/50 dark:border-zinc-700/50",children:[e.jsx("h4",{className:"text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-3",children:"Estatísticas do Período"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:["Preto","Verde","Cinza","Vermelho"].map(s=>{const a=Bs.reduce((e,a)=>{if(!(a.left===s||a.right===s))return e;const t=a.winner===s,r="Empate"===a.winner;return{games:e.games+1,wins:e.wins+(t?1:0),draws:e.draws+(r?1:0),losses:e.losses+(t||r?0:1),goalsFor:e.goalsFor+(a.left===s?a.leftScore:a.rightScore),goalsAgainst:e.goalsAgainst+(a.left===s?a.rightScore:a.leftScore)}},{games:0,wins:0,draws:0,losses:0,goalsFor:0,goalsAgainst:0});if(0===a.games)return null;const t=Math.round(a.wins/a.games*100);return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[e.jsx(K,{color:s}),e.jsx("span",{className:"text-xs font-medium text-zinc-600 dark:text-zinc-300",children:s})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[a.games," ",1===a.games?"jogo":"jogos"]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[e.jsxs("span",{className:"text-emerald-600 dark:text-emerald-400 font-medium",children:[a.wins,"V"]}),e.jsxs("span",{className:"text-amber-600 dark:text-amber-400 font-medium",children:[a.draws,"E"]}),e.jsxs("span",{className:"text-red-600 dark:text-red-400 font-medium",children:[a.losses,"D"]})]}),e.jsxs("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[a.goalsFor,"-",a.goalsAgainst," gols"]}),e.jsxs("div",{className:"text-xs font-medium "+(t>=60?"text-emerald-600 dark:text-emerald-400":t>=40?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"),children:[t,"% vitórias"]})]})]},s)}).filter(Boolean)})]}),0===_e.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-zinc-100 dark:bg-zinc-800 rounded-full flex items-center justify-center",children:e.jsx(h,{className:"w-8 h-8 text-zinc-400"})}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Sem registros ainda."}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:"As partidas aparecerão aqui após serem finalizadas"})]}):e.jsx("div",{className:"space-y-3",children:Bs.map(s=>{const a=e=>s.winner===e,t="Empate"===s.winner,r=new Date(s.ts);return e.jsxs("button",{onClick:()=>(js(s),void us(!0)),className:"w-full bg-zinc-50 dark:bg-zinc-800/50 rounded-xl p-4 border border-zinc-200/50 dark:border-zinc-700/50 hover:shadow-md hover:bg-zinc-100 dark:hover:bg-zinc-700/50 hover:border-maestros-green/30 transition-all duration-200 cursor-pointer group text-left",title:"Clique para ver os gols da partida",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-maestros-green/10 text-maestros-green px-2 py-1 rounded-lg text-xs font-medium",children:["Rodada #",s.round]}),t&&e.jsx("div",{className:"bg-amber-100 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400 px-2 py-1 rounded-lg text-xs font-medium",children:"Empate"})]}),e.jsxs("div",{className:"text-right relative",children:[e.jsx("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:r.toLocaleDateString("pt-BR")}),e.jsx("div",{className:"text-xs text-zinc-400 dark:text-zinc-500",children:r.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{className:"absolute -top-1 -right-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"w-2 h-2 bg-maestros-green rounded-full animate-pulse"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{color:s.left}),e.jsx("span",{className:"font-medium text-sm "+(a(s.left)?"text-emerald-600 dark:text-emerald-400":"text-zinc-600 dark:text-zinc-300"),children:s.left}),a(s.left)&&e.jsx(h,{className:"w-4 h-4 text-emerald-500"})]})}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2",children:[e.jsx("div",{className:`text-xl font-bold transition-colors ${a(s.left)?"text-emerald-600 dark:text-emerald-400":"text-zinc-600 dark:text-zinc-400"} group-hover:text-maestros-green`,children:s.leftScore}),e.jsx("div",{className:"text-zinc-400 dark:text-zinc-500 font-medium group-hover:text-maestros-green transition-colors",children:"×"}),e.jsx("div",{className:`text-xl font-bold transition-colors ${a(s.right)?"text-emerald-600 dark:text-emerald-400":"text-zinc-600 dark:text-zinc-400"} group-hover:text-maestros-green`,children:s.rightScore})]}),e.jsx("div",{className:"flex items-center gap-3 flex-1 justify-end",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a(s.right)&&e.jsx(h,{className:"w-4 h-4 text-emerald-500"}),e.jsx("span",{className:"font-medium text-sm "+(a(s.right)?"text-emerald-600 dark:text-emerald-400":"text-zinc-600 dark:text-zinc-300"),children:s.right}),e.jsx(K,{color:s.right})]})})]})]},s.round+"-"+s.ts)})})]})}),e.jsx(b,{open:Je,onOpenChange:e=>{$e(e),e||qe(null)},children:e.jsxs(f,{className:"z-[99999] max-w-md",children:[e.jsxs(v,{children:[e.jsx(N,{children:Re?"Editar Gol":"Registrar Gol"}),e.jsx(y,{children:"Autor pré-selecionado; assistência é opcional. Autoassistência não é permitida."}),Me().length>0?e.jsxs("div",{className:"mt-2 text-green-600 text-xs flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),"Usando jogadores do sorteio oficial"]}):e.jsxs("div",{className:"mt-2 text-amber-600 text-xs flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),"Usando jogadores de exemplo (carregue o sorteio)"]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:['Debug: Autor atual = "',Ue,'" | Jogadores disponíveis = ',As(Fe).length]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"mr-2",children:"Time:"}),e.jsx(K,{color:Fe})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(z,{htmlFor:"goal-author",children:"Autor do gol"}),e.jsxs(k,{value:Ue,onValueChange:e=>{Ze(e),Qe===e&&Ye("none")},children:[e.jsx(C,{id:"goal-author",children:e.jsx(S,{placeholder:"Selecione o autor"})}),e.jsx(A,{className:"z-[100000]",position:"popper",sideOffset:5,children:As(Fe).map(s=>e.jsx(P,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(z,{htmlFor:"goal-assist",children:"Assistência (opcional)"}),e.jsxs(k,{value:Qe,onValueChange:e=>{Ye(e)},children:[e.jsx(C,{id:"goal-assist",children:e.jsx(S,{placeholder:"Selecione (opcional)"})}),e.jsxs(A,{className:"z-[100000]",position:"popper",sideOffset:5,children:[e.jsx(P,{value:"none",children:"Sem assistência"}),As(Fe).filter(e=>e!==Ue).map(s=>e.jsx(P,{value:s,children:s},s))]})]})]})]}),e.jsxs(w,{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:['Debug: Autor atual = "',Ue,'" | Jogadores disponíveis = ',As(Fe).length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{type:"button",variant:"default",onClick:async()=>{if(!Ue)return void alert("Selecione o autor do gol");const e="none"===Qe?null:Qe;if(Ue!==e)try{if(Re){const s=O.find(e=>e.id===Re);s&&(s.author&&s.author!==Ue&&me(s.author),s.assist&&s.assist!==e&&xe(s.assist),Ue!==s.author&&de(Ue),e&&e!==s.assist&&oe(e)),ee(Re,{author:Ue,assist:e??null})}else{if(W({team:Fe,author:Ue,assist:e??null}),pe)try{await ue({matchId:pe,playerId:Ue,assistPlayerId:e||void 0,team:Fe,minute:Math.floor(r.accumulatedSec/60),roundNumber:r.number,isOwnGoal:!1,isPenalty:!1})}catch(s){}de(Ue),e&&oe(e)}$e(!1),qe(null)}catch(s){alert("Erro ao salvar gol: "+s.message)}else alert("Jogador não pode dar assistência para si mesmo")},className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Salvar Gol"]}),e.jsx(o,{type:"button",variant:"secondary",onClick:()=>$e(!1),children:"Cancelar"})]})]})]})}),e.jsx(b,{open:Ke,onOpenChange:We,children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"Excluir gol?"}),e.jsx(y,{children:"Essa ação não pode ser desfeita. O placar será atualizado."})]}),Xe&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"Time:"}),e.jsx(K,{color:Xe.team})]}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Autor:"})," ",Xe.author]}),Xe.assist&&e.jsxs("div",{className:"text-zinc-600",children:[e.jsx("strong",{children:"Assistência:"})," ",Xe.assist]}),e.jsxs("div",{className:"text-zinc-600",children:[e.jsx("strong",{children:"Horário:"})," ",new Date(Xe.ts).toLocaleTimeString()]})]})]}),e.jsxs(w,{children:[e.jsx(o,{type:"button",variant:"secondary",onClick:()=>{We(!1),es(null)},children:"Não"}),e.jsx(o,{type:"button",className:"bg-red-600 hover:bg-red-600/90",onClick:()=>{Xe&&(Xe.author&&me(Xe.author),Xe.assist&&xe(Xe.assist),se(Xe.id),We(!1),es(null))},children:"Sim, excluir"})]})]})}),e.jsx(b,{open:ss,onOpenChange:as,children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"Encerrar rodada"}),e.jsx(y,{children:"O vencedor permanece. Escolha o próximo adversário ou deixe automático."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(z,{children:"Próximo time a entrar"}),e.jsxs(k,{value:ts,onValueChange:e=>rs(e),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Selecione o próximo"})}),e.jsx(A,{children:Vs.map(s=>e.jsx(P,{value:s,children:s},s))})]})]}),e.jsxs(w,{children:[e.jsx(o,{variant:"secondary",onClick:()=>as(!1),children:"Cancelar"}),e.jsx(o,{onClick:()=>{try{if(ws){if(!["Preto","Verde","Cinza","Vermelho"].includes(ts))return;const{round:e,events:s}=_.getState(),[a,t]=e.inPlay,r=e.scores[a]??0,n=e.scores[t]??0,i={round:e.number,left:a,right:t,leftScore:r,rightScore:n,winner:ws,ts:Date.now(),goals:[...s]},l=ws,c=ts;_.setState({history:[..._.getState().history,i],round:{number:e.number+1,inPlay:[l,c],scores:{Preto:0,Verde:0,Cinza:0,Vermelho:0},running:!1},events:[],allEvents:[..._.getState().allEvents],accumulatedSec:0,runningSince:null}),as(!1),zs(null)}else ae(ts),as(!1)}catch(e){as(!1)}},children:"Confirmar"})]})]})}),e.jsx(b,{open:ps,onOpenChange:e=>{if(!e){if(Ns)return void bs(!0);Ss()}},children:e.jsxs(f,{className:"max-w-md",children:[e.jsxs(v,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-amber-500"}),Ns?"Determinando Vencedor...":"Empate! Vencedor Sorteado"]}),e.jsx(y,{children:Ns?"As cores dos times estão competindo para determinar o vencedor!":"O vencedor foi determinado por sorteio justo!"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center items-center space-x-4",children:r.inPlay.map((s,a)=>{const t=!Ns&&fs===s;return e.jsx("div",{className:`\n                      w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-lg\n                      ${{Preto:"bg-zinc-800",Verde:"bg-green-500",Cinza:"bg-gray-500",Vermelho:"bg-red-500"}[s]}\n                      ${Ns?"animate-bounce":""}\n                      ${t?"ring-4 ring-yellow-400 scale-110":""}\n                      transition-all duration-500\n                    `,children:Ns?e.jsx(j,{className:"w-8 h-8 animate-spin"}):t?e.jsx(h,{className:"w-8 h-8 text-yellow-400"}):e.jsx("span",{className:"text-xs",children:s.charAt(0)})},s)})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[r.scores[r.inPlay[0]]," - ",r.scores[r.inPlay[1]]]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Empate!"})]}),!Ns&&fs&&e.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold text-amber-800 mb-2",children:["🏆 Vencedor: ",fs]}),e.jsxs("div",{className:"text-sm text-amber-600",children:["O time ",fs," continuará na próxima rodada!"]})]})})]}),e.jsx(w,{children:!Ns&&e.jsxs(o,{onClick:()=>{if(fs)try{zs(fs),bs(!1),vs(null),ys(!1),as(!0)}catch(e){Ss()}},className:"w-full bg-amber-600 hover:bg-amber-700 text-white",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Continuar com ",fs]})})]})}),e.jsx(b,{open:ns,onOpenChange:e=>{is(e),e||(os(""),xs(""))},children:e.jsxs(f,{className:"z-[99999]",children:[e.jsxs(v,{children:[e.jsxs(N,{children:["Substituição - ",ls]}),e.jsx(y,{children:"Selecione o jogador que sai e o que entra. A substituição será registrada no histórico."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"mr-2",children:"Time:"}),e.jsx(K,{color:ls})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(z,{children:"Jogador que sai (ativo)"}),e.jsxs(k,{value:ds,onValueChange:os,children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Selecione quem sai"})}),e.jsx(A,{children:Ls(ls).playersOut.map(s=>e.jsx(P,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(z,{children:"Jogador que entra (banco)"}),e.jsxs(k,{value:ms,onValueChange:xs,children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Selecione quem entra"})}),e.jsx(A,{children:Ls(ls).playersIn.map(s=>e.jsx(P,{value:s,children:s},s))})]})]}),0===Ls(ls).playersIn.length&&e.jsx("div",{className:"text-sm text-amber-600 bg-amber-50 p-2 rounded",children:"⚠️ Não há jogadores no banco para substituição"})]}),e.jsxs(w,{children:[e.jsx(o,{type:"button",variant:"secondary",onClick:()=>is(!1),children:"Cancelar"}),e.jsx(o,{type:"button",onClick:()=>{if(ds&&ms)if(ds!==ms)try{we(ls,ds,ms),is(!1),os(""),xs("")}catch(e){alert("Erro ao realizar substituição: "+e.message)}else alert("Jogador que sai deve ser diferente do que entra");else alert("Selecione ambos os jogadores para a substituição")},disabled:!ds||!ms,children:"Confirmar Substituição"})]})]})}),e.jsx(b,{open:hs,onOpenChange:us,children:e.jsxs(f,{className:"max-w-md",children:[e.jsxs(v,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5 text-maestros-green"}),"Gols da Rodada #",gs?.round]}),e.jsx(y,{children:gs&&`${gs.left} vs ${gs.right} (${gs.leftScore}-${gs.rightScore})`})]}),e.jsx("div",{className:"space-y-4",children:gs?.goals&&gs.goals.length>0?e.jsx("div",{className:"space-y-3",children:gs.goals.slice().sort((e,s)=>e.ts-s.ts).map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-zinc-50 dark:bg-zinc-800/50 rounded-lg border border-zinc-200/50 dark:border-zinc-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-medium text-zinc-500 dark:text-zinc-400 bg-zinc-200 dark:bg-zinc-700 px-2 py-1 rounded",children:[a+1,"º"]}),e.jsx(K,{color:s.team})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm text-zinc-900 dark:text-zinc-100",children:s.author}),e.jsxs("span",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:["(",s.team,")"]})]}),s.assist&&e.jsxs("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 mt-1",children:["Assistência: ",e.jsx("span",{className:"font-medium",children:s.assist})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-xs text-zinc-400 dark:text-zinc-500",children:new Date(s.ts).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit",second:"2-digit"})})})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-zinc-100 dark:bg-zinc-800 rounded-full flex items-center justify-center",children:e.jsx(h,{className:"w-8 h-8 text-zinc-400"})}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Nenhum gol foi marcado nesta rodada"}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:"A partida terminou 0-0"})]})}),e.jsx(w,{children:e.jsx(o,{variant:"outline",onClick:()=>us(!1),className:"w-full",children:"Fechar"})})]})}),e.jsx(X,{clearEvents:ne,clearHistory:re,clearAll:ie,resetToInitialState:le,canControlMatch:Ae()})]})};function X({clearEvents:s,clearHistory:a,clearAll:t,resetToInitialState:r,canControlMatch:n}){return n?e.jsx(m,{className:"rounded-2xl border border-amber-200 bg-amber-50 shadow-sm dark:border-amber-800 dark:bg-amber-950/30 mt-6",children:e.jsxs(x,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(p,{className:"w-4 h-4 text-amber-600"}),e.jsx("h3",{className:"text-sm font-semibold text-amber-800 dark:text-amber-300",children:"Controles de Teste"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[e.jsxs(o,{onClick:s,variant:"outline",size:"sm",className:"border-amber-300 text-amber-700 hover:bg-amber-100 dark:border-amber-700 dark:text-amber-400 dark:hover:bg-amber-900/50",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"Limpar Gols"]}),e.jsxs(o,{onClick:a,variant:"outline",size:"sm",className:"border-amber-300 text-amber-700 hover:bg-amber-100 dark:border-amber-700 dark:text-amber-400 dark:hover:bg-amber-900/50",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),"Limpar Histórico"]}),e.jsxs(o,{onClick:t,variant:"outline",size:"sm",className:"border-amber-300 text-amber-700 hover:bg-amber-100 dark:border-amber-700 dark:text-amber-400 dark:hover:bg-amber-900/50",children:[e.jsx(q,{className:"w-3 h-3 mr-1"}),"Limpar Tudo"]}),e.jsxs(o,{onClick:()=>{r(),alert("Partida resetada! Ranking mantido.")},variant:"outline",size:"sm",className:"border-red-300 text-red-700 hover:bg-red-100 dark:border-red-700 dark:text-red-400 dark:hover:bg-red-900/50",children:[e.jsx($,{className:"w-3 h-3 mr-1"}),"Reset Total"]})]}),e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-500 mt-2",children:"⚠️ Estes botões são para facilitar testes durante o desenvolvimento"})]})}):null}export{W as Match,W as default};
