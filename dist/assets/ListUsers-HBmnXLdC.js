import{j as e}from"./vendor-ui-Cg0qxSES.js";import{g as s,i as a,B as t,R as r,C as l,f as i,S as c,Z as o,d as n,e as m,U as d}from"./index-XxW9FBxQ.js";import{B as x}from"./badge-hWvPWwxj.js";import{I as h}from"./input-uMYoR_2G.js";import{r as u}from"./vendor-react-CyD6OLG_.js";import{U as j}from"./users-CT76zCld.js";import{C as p}from"./crown-CyBj_N2G.js";import{S as g}from"./shield-DWCzQdRN.js";import{D as N}from"./database-Ce_Wfjf8.js";import{G as f}from"./globe-D87ER12r.js";import{S as b}from"./search-Vi8H8w3g.js";import{M as w}from"./mail-C10ji3et.js";import"./vendor-router-VFXGavtY.js";import"./vendor-pdf-oqmhCI76.js";import"./vendor-utils-CrFdsnXa.js";function v(){const[v,y]=u.useState([]),[S,C]=u.useState(!1),[L,_]=u.useState("");s();const{success:E,error:A}=a(),D=s=>{switch(s){case"owner":return e.jsx(p,{className:"w-4 h-4 text-yellow-600"});case"admin":return e.jsx(g,{className:"w-4 h-4 text-blue-600"});case"aux":return e.jsx(o,{className:"w-4 h-4 text-purple-600"});case"mensalista":return e.jsx(c,{className:"w-4 h-4 text-green-600"});case"diarista":return e.jsx(o,{className:"w-4 h-4 text-orange-600"});default:return e.jsx(d,{className:"w-4 h-4 text-gray-600"})}},U=e=>{switch(e){case"owner":return"bg-yellow-100 text-yellow-800";case"admin":return"bg-blue-100 text-blue-800";case"aux":return"bg-purple-100 text-purple-800";case"mensalista":return"bg-green-100 text-green-800";case"diarista":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},B=async()=>{C(!0);try{const s=[],a=localStorage.getItem("offline_user");if(a)try{const e=JSON.parse(a);s.push({id:e.id,email:e.email||"Sem email",name:e.name||"Sem nome",role:e.role||"N/A",source:"local"})}catch(e){}const t=localStorage.getItem("all_users");if(t)try{JSON.parse(t).forEach(e=>{s.some(s=>s.id===e.id)||s.push({id:e.id,email:e.email||"Sem email",name:e.name||"Sem nome",role:e.role||"N/A",source:"local",loginDate:e.loginDate,lastSeen:e.lastSeen})})}catch(e){}try{const{data:e,error:a}=await supabase.from("profiles").select("*").order("updated_at",{ascending:!1});!a&&e&&e.forEach(e=>{s.push({id:e.id,email:e.email||"Sem email",name:e.email?.split("@")[0]||"Sem nome",role:e.role||"N/A",membership:e.membership,position:e.position,stars:e.stars,created_at:e.updated_at,source:"supabase"})})}catch(e){}try{const{data:e,error:a}=await supabase.from("users").select("*").order("created_at",{ascending:!1});!a&&e&&e.forEach(e=>{s.push({id:e.id,email:e.email||"Sem email",name:e.name||"Sem nome",role:e.role||"N/A",created_at:e.created_at,source:"supabase"})})}catch(e){}y(s),E("Usuários carregados",`${s.length} usuários encontrados`)}catch(s){A("Erro ao carregar usuários","Tente novamente")}finally{C(!1)}};u.useEffect(()=>{B()},[]);const I=v.filter(e=>e.email.toLowerCase().includes(L.toLowerCase())||e.name.toLowerCase().includes(L.toLowerCase())||e.role.toLowerCase().includes(L.toLowerCase())),O={total:v.length,owners:v.filter(e=>"owner"===e.role).length,admins:v.filter(e=>"admin"===e.role).length,mensalistas:v.filter(e=>"mensalista"===e.role).length,diaristas:v.filter(e=>"diarista"===e.role).length,local:v.filter(e=>"local"===e.source).length,supabase:v.filter(e=>"supabase"===e.source).length};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Usuários do Sistema"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Lista completa de usuários cadastrados"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{onClick:B,disabled:S,children:[e.jsx(r,{className:"w-4 h-4 mr-2 "+(S?"animate-spin":"")}),"Atualizar"]}),e.jsx(t,{variant:"outline",onClick:()=>{confirm("Tem certeza que deseja limpar o histórico de usuários?")&&(localStorage.removeItem("all_users"),B())},children:"Limpar Histórico"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsx(l,{children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(j,{className:"w-6 h-6 mx-auto mb-2 text-blue-600"}),e.jsx("div",{className:"text-2xl font-bold",children:O.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]})}),e.jsx(l,{children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(p,{className:"w-6 h-6 mx-auto mb-2 text-yellow-600"}),e.jsx("div",{className:"text-2xl font-bold",children:O.owners}),e.jsx("div",{className:"text-sm text-gray-600",children:"Owners"})]})}),e.jsx(l,{children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(g,{className:"w-6 h-6 mx-auto mb-2 text-blue-600"}),e.jsx("div",{className:"text-2xl font-bold",children:O.admins}),e.jsx("div",{className:"text-sm text-gray-600",children:"Admins"})]})}),e.jsx(l,{children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(c,{className:"w-6 h-6 mx-auto mb-2 text-green-600"}),e.jsx("div",{className:"text-2xl font-bold",children:O.mensalistas}),e.jsx("div",{className:"text-sm text-gray-600",children:"Mensalistas"})]})}),e.jsx(l,{children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(o,{className:"w-6 h-6 mx-auto mb-2 text-orange-600"}),e.jsx("div",{className:"text-2xl font-bold",children:O.diaristas}),e.jsx("div",{className:"text-sm text-gray-600",children:"Diaristas"})]})}),e.jsx(l,{children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(N,{className:"w-6 h-6 mx-auto mb-2 text-purple-600"}),e.jsx("div",{className:"text-2xl font-bold",children:O.local}),e.jsx("div",{className:"text-sm text-gray-600",children:"Local"})]})}),e.jsx(l,{children:e.jsxs(i,{className:"p-4 text-center",children:[e.jsx(f,{className:"w-6 h-6 mx-auto mb-2 text-indigo-600"}),e.jsx("div",{className:"text-2xl font-bold",children:O.supabase}),e.jsx("div",{className:"text-sm text-gray-600",children:"Supabase"})]})})]}),e.jsx(l,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(h,{placeholder:"Buscar por email, nome ou role...",value:L,onChange:e=>_(e.target.value),className:"pl-10"})]})})}),e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Usuários Encontrados (",I.length,")"]})}),e.jsx(i,{children:0===I.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(j,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Nenhum usuário encontrado"})]}):e.jsx("div",{className:"space-y-3",children:I.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:D(s.role)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(w,{className:"w-3 h-3"}),s.email]}),s.position&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Posição: ",s.position]}),s.lastSeen&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Último acesso: ",new Date(s.lastSeen).toLocaleString("pt-BR")]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{className:U(s.role),children:s.role}),e.jsx(x,{variant:"outline",children:"local"===s.source?"Local":"Supabase"}),s.stars&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600",children:[e.jsx(c,{className:"w-3 h-3"}),s.stars]})]})]},`${s.source}-${s.id}`))})})]})]})})}export{v as default};
