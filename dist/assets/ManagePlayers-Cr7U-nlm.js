import{j as e}from"./vendor-ui-Crwl98nu.js";import{r as s}from"./vendor-react-Cf1qRDNe.js";import{c as a,u as r,B as t,C as i,b as o,e as l,d as n,S as c}from"./index-D4lv_L5s.js";import{I as d}from"./input-DgMKldUO.js";import{L as m}from"./label-C1dG6DTd.js";import{S as h,a as x,b as p,c as j,d as u}from"./select-DOFi3y6O.js";import{B as g}from"./badge-BqDrbTf5.js";import{D as v,f,a as N,b as y,c as b}from"./dialog-CH6W1Vak.js";import{supabase as w}from"./supabase-Bm48QYjr.js";import{u as S}from"./usePermissions-Dx433XVy.js";import{P as T}from"./plus-CQ2o4efs.js";import{U as A}from"./users-BSGs48q5.js";import{S as _}from"./square-pen-BNenVYo6.js";import{T as C}from"./trash-2-3xRMomrh.js";import"./vendor-router-Cpu-KcQe.js";import"./vendor-supabase-Dvt-yfip.js";import"./vendor-utils-CRulVwns.js";import"./check-BOIfqwE8.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=a("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);let E=0;const I=new Map,M=e=>{if(I.has(e))return;const s=setTimeout(()=>{I.delete(e),J({type:"REMOVE_TOAST",toastId:e})},1e6);I.set(e,s)},O=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{const{toastId:a}=s;return a?M(a):e.toasts.forEach(e=>{M(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":return void 0===s.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},G=[];let D={toasts:[]};function J(e){D=O(D,e),G.forEach(e=>{e(D)})}function F({...e}){const s=(E=(E+1)%Number.MAX_SAFE_INTEGER,E.toString()),a=()=>J({type:"DISMISS_TOAST",toastId:s});return J({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>J({type:"UPDATE_TOAST",toast:{...e,id:s}})}}const k=()=>{const{toast:e}=function(){const[e,a]=s.useState(D);return s.useEffect(()=>(G.push(a),()=>{const e=G.indexOf(a);e>-1&&G.splice(e,1)}),[e]),{...e,toast:F,dismiss:e=>J({type:"DISMISS_TOAST",toastId:e})}}();return{success:(s,a)=>{e({title:s,description:a,variant:"default"})},error:(s,a)=>{e({title:s,description:a,variant:"destructive"})}}};function V(){r();const{success:a,error:E}=k(),{canManagePlayers:I}=S(),[M,O]=s.useState([]),[G,D]=s.useState(!0),[J,F]=s.useState(!1),[V,q]=s.useState(null),[P,R]=s.useState({name:"",email:"",role:"diarista",position:"Meio",stars:5,shirt_size:"G",approved:!0});s.useEffect(()=>{$()},[]);const $=async()=>{try{D(!0);const{data:e,error:s}=await w.from("users").select("*").order("created_at",{ascending:!1});if(s)throw s;O(e||[])}catch(e){E("Erro ao carregar jogadores",e.message)}finally{D(!1)}},U=()=>{R({name:"",email:"",role:"diarista",position:"Meio",stars:5,shirt_size:"G",approved:!0}),q(null)},Z=e=>{switch(e){case"owner":return"bg-purple-100 text-purple-800";case"admin":return"bg-blue-100 text-blue-800";case"aux":return"bg-green-100 text-green-800";case"mensalista":return"bg-yellow-100 text-yellow-800";case"diarista":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},B=e=>{switch(e){case"Gol":return"🥅";case"Zaga":return"🛡️";case"Meio":return"⚽";case"Atacante":return"🎯";default:return"👤"}};return I()?G?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciar Jogadores"}),e.jsx("p",{className:"text-gray-600",children:"Cadastre e gerencie os jogadores do grupo"})]}),e.jsxs(v,{open:J,onOpenChange:e=>{F(e),e||U()},children:[e.jsx(f,{asChild:!0,children:e.jsxs(t,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Novo Jogador"]})}),e.jsxs(N,{className:"max-w-md",children:[e.jsx(y,{children:e.jsx(b,{children:V?"Editar Jogador":"Novo Jogador"})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),P.name&&P.email)try{if(V){const{error:e}=await w.from("users").update({name:P.name,email:P.email,role:P.role,position:P.position,stars:P.stars,shirt_size:P.shirt_size,approved:P.approved}).eq("id",V.id);if(e)throw e;a("Jogador atualizado",`${P.name} foi atualizado com sucesso`)}else{const{error:e}=await w.from("users").insert({name:P.name,email:P.email,role:P.role,position:P.position,stars:P.stars,shirt_size:P.shirt_size,approved:P.approved});if(e)throw e;a("Jogador criado",`${P.name} foi adicionado ao sistema`)}U(),$(),F(!1)}catch(s){E("Erro ao salvar",s.message)}else E("Campos obrigatórios","Nome e email são obrigatórios")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"name",children:"Nome Completo *"}),e.jsx(d,{id:"name",value:P.name,onChange:e=>R(s=>({...s,name:e.target.value})),placeholder:"Nome do jogador",required:!0})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"email",children:"Email *"}),e.jsx(d,{id:"email",type:"email",value:P.email,onChange:e=>R(s=>({...s,email:e.target.value})),placeholder:"email@exemplo.com",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"role",children:"Função"}),e.jsxs(h,{value:P.role,onValueChange:e=>R(s=>({...s,role:e})),children:[e.jsx(x,{children:e.jsx(p,{})}),e.jsxs(j,{children:[e.jsx(u,{value:"diarista",children:"Diarista"}),e.jsx(u,{value:"mensalista",children:"Mensalista"}),e.jsx(u,{value:"aux",children:"Auxiliar"}),e.jsx(u,{value:"admin",children:"Admin"})]})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"position",children:"Posição"}),e.jsxs(h,{value:P.position,onValueChange:e=>R(s=>({...s,position:e})),children:[e.jsx(x,{children:e.jsx(p,{})}),e.jsxs(j,{children:[e.jsx(u,{value:"Gol",children:"Goleiro"}),e.jsx(u,{value:"Zaga",children:"Zagueiro"}),e.jsx(u,{value:"Meio",children:"Meio-campo"}),e.jsx(u,{value:"Atacante",children:"Atacante"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"stars",children:"Estrelas (1-10)"}),e.jsx(d,{id:"stars",type:"number",min:"1",max:"10",value:P.stars,onChange:e=>R(s=>({...s,stars:parseInt(e.target.value)||5}))})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"shirt_size",children:"Tamanho da Camisa"}),e.jsxs(h,{value:P.shirt_size,onValueChange:e=>R(s=>({...s,shirt_size:e})),children:[e.jsx(x,{children:e.jsx(p,{})}),e.jsxs(j,{children:[e.jsx(u,{value:"G",children:"G"}),e.jsx(u,{value:"GG",children:"GG"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"approved",checked:P.approved,onChange:e=>R(s=>({...s,approved:e.target.checked})),className:"rounded"}),e.jsx(m,{htmlFor:"approved",children:"Jogador aprovado"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(t,{type:"submit",className:"flex-1",children:V?"Atualizar":"Criar"}),e.jsx(t,{type:"button",variant:"outline",onClick:()=>F(!1),children:"Cancelar"})]})]})]})]})]}),e.jsxs(i,{children:[e.jsx(o,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Jogadores Cadastrados (",M.length,")"]})}),e.jsx(n,{children:0===M.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum jogador cadastrado ainda"}),e.jsx("p",{className:"text-sm text-gray-400",children:'Clique em "Novo Jogador" para começar'})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M.map(s=>e.jsx(i,{className:"relative",children:e.jsxs(n,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:s.stars},(s,a)=>e.jsx(c,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"},a))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:Z(s.role),children:s.role}),s.approved&&e.jsx(g,{variant:"outline",className:"text-green-600 border-green-600",children:"Aprovado"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("span",{children:[B(s.position)," ",s.position]}),e.jsx("span",{children:"•"}),e.jsx(z,{className:"w-3 h-3"}),e.jsx("span",{children:s.shirt_size})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(t,{size:"sm",variant:"outline",onClick:()=>(e=>{q(e),R({name:e.name,email:e.email,role:e.role,position:e.position,stars:e.stars,shirt_size:e.shirt_size,approved:e.approved}),F(!0)})(s),className:"flex-1",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Editar"]}),e.jsxs(t,{size:"sm",variant:"destructive",onClick:()=>(async(e,s)=>{if(confirm(`Tem certeza que deseja remover ${s}?`))try{const{error:r}=await w.from("users").delete().eq("id",e);if(r)throw r;a("Jogador removido",`${s} foi removido do sistema`),$()}catch(r){E("Erro ao remover",r.message)}})(s.id,s.name),className:"flex-1",children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),"Remover"]})]})]})},s.id))})})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Acesso Negado"}),e.jsx("p",{className:"text-gray-600",children:"Você não tem permissão para gerenciar jogadores."})]})})}export{V as default};
