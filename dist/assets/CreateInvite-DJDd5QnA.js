import{j as e}from"./vendor-ui-Cg0qxSES.js";import{g as s,C as a,f as i,d as t,e as r,S as l,Z as n,B as c}from"./index-XxW9FBxQ.js";import{B as d}from"./badge-hWvPWwxj.js";import{I as o}from"./input-uMYoR_2G.js";import{L as m}from"./label-CfKHBYYN.js";import{S as x,a as p,b as j,c as h,d as v}from"./select-DPwYioei.js";import{T as u,a as g,b as N,c as f}from"./tabs-DCR6OKyG.js";import{r as y,c as w}from"./vendor-react-CyD6OLG_.js";import{S as b}from"./shield-DWCzQdRN.js";import{U as C}from"./user-plus-2isPmhvc.js";import{M as D}from"./mail-C10ji3et.js";import{U as I}from"./users-CT76zCld.js";import{C as k}from"./copy-BU4q-tvH.js";import"./vendor-router-VFXGavtY.js";import"./vendor-pdf-oqmhCI76.js";import"./vendor-utils-CrFdsnXa.js";import"./check-Cf6Eusfg.js";function S(){const{user:S}=s(),[A,L]=y.useState(!1),[E,z]=y.useState(""),{invites:$,createInvite:B,revokeInvite:R,isLoading:F}={invites:[],createInvite:async e=>({inviteId:`invite_${Date.now()}`,token:`token_${Date.now()}`}),revokeInvite:async e=>({success:!0}),isLoading:!1},[U,V]=y.useState({type:"mensalista",email:"",expiresIn:"1"});if(!S||!["owner","admin","aux"].includes(S.role||""))return e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(a,{children:e.jsxs(i,{className:"p-6 text-center space-y-4",children:[e.jsx(b,{className:"w-12 h-12 mx-auto text-red-500"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Acesso Restrito"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Apenas Owner, Admin ou Auxiliar podem criar convites."})]})})});const M=e=>"mensalista"===e?"bg-purple-100 text-purple-800":"bg-orange-100 text-orange-800";return w.useEffect(()=>{const e=JSON.parse(localStorage.getItem("invites")||"[]");setInvites(e)},[]),e.jsxs("div",{className:"p-4 sm:p-6 space-y-6 pb-20",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(C,{className:"w-6 h-6 text-blue-600"}),"Criar Convites"]}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Convide novos jogadores para o grupo"})]}),e.jsxs(u,{defaultValue:"create",className:"w-full",children:[e.jsxs(g,{className:"grid w-full grid-cols-2",children:[e.jsx(N,{value:"create",children:"Criar Convite"}),e.jsx(N,{value:"list",children:"Convites Enviados"})]}),e.jsx(f,{value:"create",className:"space-y-4",children:e.jsxs(a,{children:[e.jsx(t,{children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Novo Convite"]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"type",children:"Tipo de Convite"}),e.jsxs(x,{value:U.type,onValueChange:e=>V({...U,type:e}),children:[e.jsx(p,{children:e.jsx(j,{})}),e.jsxs(h,{children:[e.jsx(v,{value:"mensalista",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"w-4 h-4"}),"Mensalista"]})}),e.jsx(v,{value:"diarista",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-4 h-4"}),"Diarista"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",children:"Email do Convidado"}),e.jsx(o,{id:"email",type:"email",value:U.email,onChange:e=>V({...U,email:e.target.value}),placeholder:"exemplo@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"expires",children:"Validade (dias)"}),e.jsxs(x,{value:U.expiresIn,onValueChange:e=>V({...U,expiresIn:e}),children:[e.jsx(p,{children:e.jsx(j,{})}),e.jsxs(h,{children:[e.jsx(v,{value:"1",children:"1 dia"}),e.jsx(v,{value:"3",children:"3 dias"}),e.jsx(v,{value:"7",children:"7 dias"})]})]})]}),e.jsx(c,{onClick:async()=>{L(!0),z("");try{if(!U.email)return void z("Digite o email do convidado!");await B({email:U.email,role:"player",membership:U.type}),z(`Convite ${U.type} criado com sucesso!`),V({type:"mensalista",email:"",expiresIn:"1"})}catch(e){z(`Erro: ${e}`)}finally{L(!1)}},disabled:A,className:"w-full",children:A?"Criando...":"Criar Convite"}),E&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-800",children:E})})]})]})}),e.jsx(f,{value:"list",className:"space-y-4",children:e.jsxs(a,{children:[e.jsx(t,{children:e.jsxs(r,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Convites Enviados"]})}),e.jsx(i,{children:0===$.length?e.jsx("p",{className:"text-sm text-zinc-500 text-center py-4",children:"Nenhum convite enviado ainda"}):e.jsx("div",{className:"space-y-3",children:$.map(s=>{const a=(e=>e.used?{text:"Usado",color:"bg-green-100 text-green-800"}:new Date>new Date(e.expiresAt)?{text:"Expirado",color:"bg-red-100 text-red-800"}:{text:"Ativo",color:"bg-blue-100 text-blue-800"})(s);return e.jsxs("div",{className:"p-4 border rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(i=s.type,"mensalista"===i?e.jsx(l,{className:"w-4 h-4"}):e.jsx(n,{className:"w-4 h-4"})),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.email}),e.jsxs("p",{className:"text-sm text-zinc-500",children:["Criado em ",new Date(s.createdAt).toLocaleDateString("pt-BR")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:M(s.type),children:"mensalista"===s.type?"Mensalista":"Diarista"}),e.jsx(d,{className:a.color,children:a.text})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>(e=>{const s=`${window.location.origin}/accept-invite?token=${e}`;navigator.clipboard.writeText(s),z("Link copiado para a área de transferência!")})(s.token),children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Copiar Link"]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Expira em ",new Date(s.expiresAt).toLocaleDateString("pt-BR")]})]}),s.used&&e.jsxs("div",{className:"p-2 bg-green-50 rounded text-sm text-green-800",children:["✅ Usado em ",new Date(s.usedAt).toLocaleDateString("pt-BR")]})]},s.id);var i})})})]})})]})]})}export{S as default};
