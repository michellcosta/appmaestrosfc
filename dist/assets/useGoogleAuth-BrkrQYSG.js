import{k as e,a as t,u as o}from"./index-XxW9FBxQ.js";import{r}from"./vendor-react-CyD6OLG_.js";const a={clientId:"999325053713-agf0sdhvntmerq7s56caqaisgeep3apv.apps.googleusercontent.com",redirectUri:function(){const e=window.location.hostname;return e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.")||"localhost"===e}()?"http://localhost:5173/auth/callback":`${window.location.origin}/auth/callback`,scope:"email profile"};function n(){const[o,n]=r.useState(!1),[i,s]=r.useState(null),l=e(t.auth.getCurrentUser);return r.useEffect(()=>{},[l,o]),{currentUser:l,handleGoogleSignIn:async()=>{n(!0),s(null);try{const e=`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:a.clientId,redirect_uri:a.redirectUri,response_type:"code",scope:a.scope,access_type:"offline",prompt:"consent"}).toString()}`;window.location.href=e}catch(e){throw s(e.message||"Erro no login com Google"),e}finally{n(!1)}},handleSignOut:async()=>{n(!0),s(null);try{localStorage.removeItem("offline_user"),localStorage.removeItem("user_data"),window.location.reload()}catch(e){throw s(e.message||"Erro no logout"),e}finally{n(!1)}},loading:o,error:i,isAuthenticated:!!l}}function i(){const{handleGoogleSignIn:e,handleSignOut:r,currentUser:a,loading:i,error:s,isAuthenticated:l}=n(),c=o(t.profiles.upsertProfileFromGoogle);return{handleGoogleSignIn:e,handleSignOut:r,createOrUpdateProfile:async(e,t,o="diarista",r)=>{try{return await c({email:e,full_name:t,role:o,membership:"mensalista"===o?"mensalista":"diarista",picture:r})}catch(a){throw a}},currentUser:a,loading:i,error:s,isAuthenticated:l}}export{i as u};
